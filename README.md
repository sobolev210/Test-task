# Test-task
Тестовое задание на позицию Python developer

## Как запустить:
Склонировать репозиторий, затем:

docker-compose up

Для сервиса *sensor* из *docker-compose.yml* файла можно указать количество запросов,
отправляемых в секунду. Для этого нужно изменить значение переменной **RPS**. 

Оптимальное значение для тестирования - 30 rps.

## Описание результатов:

### Sensor:
Генерирует данные (числа от 1 до 101), отправляет данные с частотой, указанной в настройках docker-compose. Формат сообщений соблюдается :)

##### Пока не удалось достичь:

 - На данный момент запускается 1 сенсор.
 - Сенсор генерирует данные с чуть меньшей частотой, чем нужно (например, при 300 RPS за 5 секунд генерируется 1250 сообщений вместо 1500)

### Controller:
API, которое включает в себя один эндпоинт /sensor-data/, принимающий сообщения от сенсора и записывающий их в файл с помощью aiofiles. 
Также, есть фоновая задача по генерации и отправке управляющего сигнала. В управляющем сигнале  status=up, если среднее 
арифметическое чисел, пришедших от сенсоров, больше 50. Если среднее арифметическое меньше 50, или нет данных, то status=down. 
При принятии решения учитываются данные в интервале:

(момент начала принятия решения - 5 сек.; момент начала принятия решения], 

где "- 5 сек." - интервал между управляющими сигналами.
Управляющий сигнал отправляется в Manipulator через открытый TCP-сокет, а также выводится в консоль.

##### Пока не удалось достичь:
 - При большом количестве данных от сенсора размер файла быстро увеличивается, и Controller начинает генерировать сигналы с большой задержкой. При примерно **30** запросах в секунду Controller выглядит рабочим, но через какое-то время может снова начать работать с задержкой (так как старые данные из файла не удаляются, и Controller каждый раз читает их заново).
 - Нет эндпоинта для получения данных об управляющих сигналах за определенный временной интервал

### Manipulator:
Принимает управляющий сигнал через TCP-сокет, выводит его в консоль.
